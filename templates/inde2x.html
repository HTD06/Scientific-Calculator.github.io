<!DOCTYPE html>
<html>
<head>
    <title>Ultimate Calculus Calculator</title>
</head>
<body>
    
    <h1>Ultimate Calculus Calculator</h1>
    <form action="/calculate" method="post" onsubmit="replacePlusSymbols()">
        <label for="equation">Enter a polynomial equation:</label>
        <input type="text" id="equation" name="equation"><br><br>
        <label for="var">Enter the input use (optional):</label>
        <input type="text" id="var" name="var"><br><br>
        <label for="result">Output:</label>
        <span id="result"></span><br><br>
        <input type="button" name="button" value="Solve using Quadratic Formula" id="solve_quadratic">
        <input type="button" name="button" value="Solve using Isolation [x]" id="solve_isolation">
        <input type="button" name="button" value="Solve using Factorization" id="solve_factorization">
        <input type="button" name="button" value="Simplify" id="simplify">
        <input type="button" name="button" value="Find Max/Min" id="find_max_min">
        <input type="button" name="button" value="Find Inflexion Points" id="find_inflexion">
        <input type="button" name="button" value="Find Derivative [#]" id="find_derivative">
        <input type="button" name="button" value="Find Zeroes" id="find_zeroes">
    </form>

    <script>
        function replacePlusSymbols() {
            var equationInput = document.querySelector('#equation');
            var equation = equationInput.value;
            equation = equation.replace(/\+/g, '%2B');
            equationInput.value = equation;
        }

        const buttons = document.querySelectorAll('input[type="button"][name="button"]');
        buttons.forEach((button) => {
            button.addEventListener('click', (e) => { // Added event object "e"
                e.preventDefault();
                console.log(`Button "${button.value}" clicked.`); // Added debugging message
                const equation = document.querySelector('#equation').value;
                const varInput = document.querySelector('#var').value;
                const buttonValue = button.value;
                const response = fetch('/calculate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: `equation=${equation}&var=${varInput}&button=${buttonValue}`,
                });
                response.then((res) => res.json())
                    .then((data) => {
                        document.querySelector('#result').innerHTML = data.result;
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                    });
            });
        });
    </script>
</body>
</html>

